function    [RES,NET_REV] = produce_results(FEE,PRICE,alternative_parameters,...
                                    input1sub,input2sub,input3sub,...
                                    errors1sub,errors2sub,errors3sub,...
                                    SIG_EP_INPUTS,reps,sto,...
                                    sort_condition,split_F_option,transfer_option,smm_est_option,...
                                    COST_PARAMETERS,PH_COUNTER,TUNE,alt_errorsub,groups)


    
[~,TU0,~,NET_REV,~,~,gamma0,~,Choices0,Total_Utility_Alt0] ...
                    = smm_shell_counterfactual_v3(  PRICE , FEE , alternative_parameters,...
                                    input1sub,input2sub,input3sub,...
                                    errors1sub,errors2sub,errors3sub,...
                                    SIG_EP_INPUTS,reps,sto,...
                                    sort_condition,split_F_option,transfer_option,smm_est_option,...
                                    COST_PARAMETERS,PH_COUNTER,TUNE,alt_errorsub);
       
    g_id1_0 = gamma0<=prctile(reshape(gamma0,size(gamma0,1)*size(gamma0,2),1),groups(1));                                 
                                
UTILITY_GAP0 = TU0 -  Total_Utility_Alt0;   
UTILITY_GAP_LOW0 = UTILITY_GAP0(g_id1_0==1);

%mean(mean(UTILITY_GAP0.*(UTILITY_GAP0>0)))

RES = [ FEE(1) ; ...
        mean(mean(Choices0==1)) ; ...
        mean(mean(Choices0==2)) ; ...
        mean(mean(UTILITY_GAP0)) ; ...
        mean(mean(UTILITY_GAP_LOW0)) ; ...
        ]    ;
